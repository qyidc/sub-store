<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloudflare Worker 1101 é”™è¯¯äº¤äº’å¼æ’æŸ¥æŒ‡å—</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Harmony (Slate/Gray neutrals, Blue accent) -->
    <!-- Application Structure Plan: A single-page application with a persistent top navigation bar to switch between thematic sections: Overview, Common Causes (interactive accordions), Diagnostic Toolkit, Solutions (code comparisons), and a Configuration Checklist. This non-linear, task-oriented structure is superior to a simple document scroll because it allows a developer to quickly jump to the specific information they need for diagnosis and fixing, mirroring a typical debugging workflow. -->
    <!-- Visualization & Content Choices: Report Info (e.g., R2 'get' returns null) -> Goal (Compare bad/good practice) -> Viz/Presentation (Side-by-side styled code blocks inside an accordion card) -> Interaction (Click to expand, click to copy code) -> Justification (Clear, actionable comparison for developers) -> Library/Method (HTML/Tailwind/JS). Process diagrams are built with styled divs and flexbox. All interactions are handled with vanilla JS. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Inter', sans-serif; }
        .nav-button { transition: all 0.2s ease-in-out; }
        .nav-button.active { background-color: #2563eb; color: white; }
        .nav-button:not(.active):hover { background-color: #e5e7eb; }
        .content-section { display: none; }
        .content-section.active { display: block; }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .code-block { position: relative; }
        .copy-button { position: absolute; top: 0.5rem; right: 0.5rem; opacity: 0.5; transition: opacity 0.2s; }
        .code-block:hover .copy-button { opacity: 1; }
        .copied-feedback { position: absolute; top: 0.5rem; right: 3rem; background-color: #10B981; color: white; padding: 0.1rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem; display: none; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900">Cloudflare Worker 1101 é”™è¯¯æ’æŸ¥æŒ‡å—</h1>
            <p class="text-slate-600 mt-2">ä¸€ä¸ªä¸º `sub-store` é¡¹ç›®å®šåˆ¶çš„äº¤äº’å¼è¯Šæ–­å·¥å…·</p>
        </header>

        <nav class="flex flex-wrap justify-center gap-2 md:gap-4 p-2 mb-8 bg-white rounded-lg shadow-sm sticky top-2 z-10">
            <button data-section="overview" class="nav-button active px-4 py-2 rounded-md text-sm md:text-base font-medium">æ¦‚è¿°</button>
            <button data-section="causes" class="nav-button px-4 py-2 rounded-md text-sm md:text-base font-medium">å¸¸è§åŸå› </button>
            <button data-section="toolkit" class="nav-button px-4 py-2 rounded-md text-sm md:text-base font-medium">è¯Šæ–­å·¥å…·</button>
            <button data-section="solutions" class="nav-button px-4 py-2 rounded-md text-sm md:text-base font-medium">è§£å†³æ–¹æ¡ˆ</button>
            <button data-section="checklist" class="nav-button px-4 py-2 rounded-md text-sm md:text-base font-medium">é…ç½®æ ¸æŸ¥æ¸…å•</button>
        </nav>

        <main>
            <!-- æ¦‚è¿° Section -->
            <section id="overview" class="content-section active">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h2 class="text-2xl font-bold mb-4">æ¬¢è¿ï¼è®©æˆ‘ä»¬å¼€å§‹è¯Šæ–­ 1101 é”™è¯¯</h2>
                    <p class="mb-4">æœ¬æŒ‡å—æ—¨åœ¨å¸®åŠ©æ‚¨ç†è§£å¹¶è§£å†³ Cloudflare Worker è¿”å›çš„ "1101: Worker Threw Exception" é”™è¯¯ã€‚è¿™ä¸ªé”™è¯¯æ˜ç¡®è¡¨ç¤ºæ‚¨çš„ Worker è„šæœ¬åœ¨è¿è¡Œæ—¶æŠ›å‡ºäº†ä¸€ä¸ªæœªè¢«æ•è·çš„ JavaScript å¼‚å¸¸ã€‚ç®€å•æ¥è¯´ï¼Œæ˜¯æ‚¨çš„ä»£ç å†…éƒ¨å‡ºäº†é—®é¢˜ï¼Œè€Œä¸æ˜¯ Cloudflare å¹³å°æ•…éšœã€‚</p>
                    <div class="p-4 bg-blue-50 border-l-4 border-blue-500 rounded-r-lg">
                        <h3 class="font-semibold text-blue-800">æ ¸å¿ƒé—®é¢˜</h3>
                        <p class="text-blue-700">æ‚¨çš„ `sub-store` åº”ç”¨è™½ç„¶èƒ½åœ¨ R2 ä¸­ç”Ÿæˆæ–‡ä»¶ï¼Œä½†åœ¨è®¿é—®æ—¶è§¦å‘ 1101 é”™è¯¯ã€‚è¿™é€šå¸¸æ„å‘³ç€é—®é¢˜å‡ºåœ¨ä» R2 è¯»å–æ–‡ä»¶ã€å¤„ç†å¤–éƒ¨ API æ•°æ®æˆ–æŸäº›å¼‚æ­¥æ“ä½œçš„é”™è¯¯å¤„ç†ä¸Šã€‚</p>
                    </div>
                    <h3 class="text-xl font-semibold mt-6 mb-3">å»ºè®®æ’æŸ¥æµç¨‹</h3>
                    <div class="flex flex-col md:flex-row items-center justify-between gap-4 text-center">
                        <div class="p-4 rounded-lg flex-1">
                           <div class="text-2xl mb-2">â‘ </div>
                           <h4 class="font-bold">äº†è§£åŸå› </h4>
                           <p class="text-sm text-slate-600">å‰å¾€â€œå¸¸è§åŸå› â€æ¿å—ï¼Œäº†è§£å¯èƒ½å¯¼è‡´é”™è¯¯çš„å„ç§ä»£ç é—®é¢˜ã€‚</p>
                        </div>
                         <div class="text-slate-300 font-mono hidden md:block">&gt;</div>
                        <div class="p-4 rounded-lg flex-1">
                           <div class="text-2xl mb-2">â‘¡</div>
                           <h4 class="font-bold">ä½¿ç”¨å·¥å…·</h4>
                           <p class="text-sm text-slate-600">åœ¨â€œè¯Šæ–­å·¥å…·â€ä¸­å­¦ä¹ å¦‚ä½•ä½¿ç”¨æ—¥å¿—ç­‰å·¥å…·å®šä½å…·ä½“é”™è¯¯ã€‚</p>
                        </div>
                         <div class="text-slate-300 font-mono hidden md:block">&gt;</div>
                        <div class="p-4 rounded-lg flex-1">
                           <div class="text-2xl mb-2">â‘¢</div>
                           <h4 class="font-bold">åº”ç”¨ä¿®å¤</h4>
                           <p class="text-sm text-slate-600">å‚è€ƒâ€œè§£å†³æ–¹æ¡ˆâ€å’Œâ€œé…ç½®æ ¸æŸ¥â€æ¥ä¿®å¤ä»£ç å’Œé…ç½®ã€‚</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- å¸¸è§åŸå›  Section -->
            <section id="causes" class="content-section">
                 <div class="bg-white p-6 rounded-lg shadow">
                    <h2 class="text-2xl font-bold mb-4">1101 é”™è¯¯çš„å¸¸è§åŸå› </h2>
                    <p class="mb-6">1101 é”™è¯¯æºäºæœªæ•è·çš„ JavaScript å¼‚å¸¸ã€‚åœ¨ Worker ç¯å¢ƒä¸­ï¼Œè¿™é€šå¸¸ä¸å¼‚æ­¥æ“ä½œæœ‰å…³ã€‚ä»¥ä¸‹æ˜¯ `sub-store` é¡¹ç›®ä¸­æœ€å¯èƒ½é‡åˆ°çš„é—®é¢˜ã€‚ç‚¹å‡»æ¯ä¸ªåŸå› ä»¥å±•å¼€æŸ¥çœ‹è¯¦æƒ…å’Œä»£ç ç¤ºä¾‹ã€‚</p>
                    <div class="space-y-4 accordion-container">
                        <!-- Accordion Item 1 -->
                        <div class="border border-slate-200 rounded-lg">
                            <button class="accordion-toggle w-full flex justify-between items-center p-4 text-left font-semibold">
                                <span>1. R2 `get()` è¿”å› `null` æœªå¤„ç†</span>
                                <span class="accordion-arrow transform transition-transform">â–¼</span>
                            </button>
                            <div class="accordion-content">
                                <div class="p-4 border-t border-slate-200">
                                    <p class="mb-4">å½“æ‚¨å°è¯•ä» R2 è·å–ä¸€ä¸ªä¸å­˜åœ¨çš„å¯¹è±¡æ—¶ï¼Œ`.get(key)` æ–¹æ³•ä¼šè¿”å› `null`ã€‚å¦‚æœæ‚¨çš„ä»£ç æ²¡æœ‰æ£€æŸ¥è¿™ä¸ª `null` å€¼ï¼Œå¹¶ç›´æ¥å°è¯•å¯¹ç»“æœè°ƒç”¨æ–¹æ³•ï¼ˆå¦‚ `.text()` æˆ– `.json()`ï¼‰ï¼Œå°±ä¼šæŠ›å‡º `TypeError`ï¼Œå¯¼è‡´ 1101 é”™è¯¯ã€‚è¿™æ˜¯æœ€å¸¸è§çš„é™·é˜±ä¹‹ä¸€ã€‚</p>
                                    <div class="grid md:grid-cols-2 gap-4">
                                        <div>
                                            <h4 class="font-semibold mb-2 text-red-600">âŒ é”™è¯¯ä»£ç </h4>
                                            <div class="code-block">
                                                <pre><code class="language-js text-sm bg-slate-100 rounded-md p-4 block overflow-x-auto">async function handle(request, env) {
  const object = await env.sub_store.get("non-existent-key");
  // å¦‚æœ object æ˜¯ null, ä¸‹ä¸€è¡Œå°†æŠ›å‡º TypeError
  const body = await object.text(); 
  return new Response(body);
}</code></pre>
                                                <button class="copy-button p-1 bg-slate-300 rounded-md text-white">ğŸ“‹</button>
                                                <div class="copied-feedback">å·²å¤åˆ¶!</div>
                                            </div>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold mb-2 text-green-600">âœ… æ­£ç¡®ä»£ç </h4>
                                            <div class="code-block">
                                                <pre><code class="language-js text-sm bg-slate-100 rounded-md p-4 block overflow-x-auto">async function handle(request, env) {
  const object = await env.sub_store.get("non-existent-key");
  if (object === null) {
    return new Response("Object Not Found", { status: 404 });
  }
  const body = await object.text();
  return new Response(body);
}</code></pre>
                                                <button class="copy-button p-1 bg-slate-300 rounded-md text-white">ğŸ“‹</button>
                                                <div class="copied-feedback">å·²å¤åˆ¶!</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Accordion Item 2 -->
                        <div class="border border-slate-200 rounded-lg">
                            <button class="accordion-toggle w-full flex justify-between items-center p-4 text-left font-semibold">
                                <span>2. å¤–éƒ¨ `fetch` é”™è¯¯æœªå¤„ç†</span>
                                <span class="accordion-arrow transform transition-transform">â–¼</span>
                            </button>
                            <div class="accordion-content">
                               <div class="p-4 border-t border-slate-200">
                                    <p class="mb-4">`sub-store` å¯èƒ½éœ€è¦ä»å¤–éƒ¨ URL è·å–è®¢é˜…æºã€‚å¦‚æœå¤–éƒ¨ API è¿”å›äº†é”™è¯¯ï¼ˆå¦‚ 404 Not Found, 500 Server Errorï¼‰ï¼Œæˆ–è€…è¿”å›çš„ä¸æ˜¯é¢„æœŸçš„ JSON æ ¼å¼ï¼Œè€Œæ‚¨çš„ä»£ç æ²¡æœ‰æ£€æŸ¥ `response.ok` å°±ç›´æ¥è°ƒç”¨ `.json()`ï¼Œä¹Ÿä¼šå¯¼è‡´å¼‚å¸¸ã€‚</p>
                                    <div class="grid md:grid-cols-2 gap-4">
                                        <div>
                                            <h4 class="font-semibold mb-2 text-red-600">âŒ é”™è¯¯ä»£ç </h4>
                                            <div class="code-block">
                                                <pre><code class="language-js text-sm bg-slate-100 rounded-md p-4 block overflow-x-auto">async function getExternalData() {
  const response = await fetch("https://api.example.com/data");
  // å¦‚æœå“åº”æ˜¯ 404 HTML é¡µé¢, .json() ä¼šå¤±è´¥
  const data = await response.json();
  return data;
}</code></pre>
                                                <button class="copy-button p-1 bg-slate-300 rounded-md text-white">ğŸ“‹</button>
                                                <div class="copied-feedback">å·²å¤åˆ¶!</div>
                                            </div>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold mb-2 text-green-600">âœ… æ­£ç¡®ä»£ç </h4>
                                            <div class="code-block">
                                                <pre><code class="language-js text-sm bg-slate-100 rounded-md p-4 block overflow-x-auto">async function getExternalData() {
  const response = await fetch("https://api.example.com/data");
  if (!response.ok) {
    throw new Error(`API error: ${response.status}`);
  }
  const data = await response.json();
  return data;
}</code></pre>
                                                <button class="copy-button p-1 bg-slate-300 rounded-md text-white">ğŸ“‹</button>
                                                <div class="copied-feedback">å·²å¤åˆ¶!</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Accordion Item 3 -->
                        <div class="border border-slate-200 rounded-lg">
                            <button class="accordion-toggle w-full flex justify-between items-center p-4 text-left font-semibold">
                                <span>3. æœªè§£æçš„ Promise</span>
                                <span class="accordion-arrow transform transition-transform">â–¼</span>
                            </button>
                             <div class="accordion-content">
                                <div class="p-4 border-t border-slate-200">
                                    <p class="mb-4">å¦‚æœæ‚¨çš„ä»£ç ä¸­å­˜åœ¨ä¸€ä¸ªæ°¸è¿œä¸ä¼šè¢«è§£æ (resolve) æˆ–æ‹’ç» (reject) çš„ Promiseï¼ŒWorker å°†æ— é™æœŸç­‰å¾…ï¼Œæœ€ç»ˆ Cloudflare ä¼šä»¥ "The script will never generate a response" çš„ä¿¡æ¯ç»ˆæ­¢å®ƒï¼Œå¹¶è¿”å› 1101 é”™è¯¯ã€‚è¿™é€šå¸¸æ˜¯ç”±äºé”™è¯¯çš„å¼‚æ­¥é€»è¾‘é€ æˆçš„ã€‚</p>
                                    <div class="grid md:grid-cols-2 gap-4">
                                        <div>
                                            <h4 class="font-semibold mb-2 text-red-600">âŒ é”™è¯¯ä»£ç </h4>
                                            <div class="code-block">
                                                <pre><code class="language-js text-sm bg-slate-100 rounded-md p-4 block overflow-x-auto">addEventListener("fetch", (event) => {
  // è¿™ä¸ª Promise æ°¸è¿œä¸ä¼šç»“æŸ
  const endlessPromise = new Promise(() => {}); 
  
  event.respondWith(
    endlessPromise.then(() => new Response("Will never happen"))
  );
});</code></pre>
                                                <button class="copy-button p-1 bg-slate-300 rounded-md text-white">ğŸ“‹</button>
                                                <div class="copied-feedback">å·²å¤åˆ¶!</div>
                                            </div>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold mb-2 text-green-600">âœ… ä¿®å¤æ€è·¯</h4>
                                           <p class="text-sm text-slate-700 bg-slate-100 p-4 rounded-md">ç¡®ä¿æ‚¨ä»£ç ä¸­çš„æ¯ä¸€ä¸ª Promise éƒ½æœ‰ä¸€ä¸ªæ˜ç¡®çš„å®Œæˆè·¯å¾„ã€‚æ£€æŸ¥æ‚¨çš„ `async/await` è°ƒç”¨é“¾ï¼Œç¡®ä¿æ‰€æœ‰å¼‚æ­¥æ“ä½œéƒ½è¢«æ­£ç¡®ç­‰å¾…ï¼Œå¹¶ä¸”æ‰€æœ‰ `.then()` éƒ½é…æœ‰ `.catch()` æ¥å¤„ç†å¯èƒ½çš„é”™è¯¯ï¼Œä»è€Œé¿å… Promise é“¾ä¸­æ–­æˆ–æ­»é”ã€‚</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- è¯Šæ–­å·¥å…· Section -->
            <section id="toolkit" class="content-section">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h2 class="text-2xl font-bold mb-4">è¯Šæ–­å·¥å…·ç®±</h2>
                    <p class="mb-6">è¦ä¿®å¤é”™è¯¯ï¼Œé¦–å…ˆå¿…é¡»æ‰¾åˆ°å®ƒã€‚Cloudflare æä¾›äº†å¼ºå¤§çš„å·¥å…·æ¥å¸®åŠ©æ‚¨æŸ¥çœ‹ Worker å†…éƒ¨å‘ç”Ÿäº†ä»€ä¹ˆã€‚ç»“åˆä½¿ç”¨è¿™äº›å·¥å…·æ˜¯å®šä½ 1101 é”™è¯¯çš„æœ€ä½³æ–¹æ³•ã€‚</p>
                    <div class="space-y-6">
                        <div>
                            <h3 class="text-xl font-semibold mb-2">1. `wrangler tail` (é¦–é€‰å·¥å…·)</h3>
                            <p class="mb-3">è¿™æ˜¯è¯Šæ–­ Worker å¼‚å¸¸çš„æœ€ç›´æ¥ã€æœ€å®æ—¶çš„æ–¹æ³•ã€‚å®ƒå¯ä»¥åœ¨æ‚¨çš„æœ¬åœ°ç»ˆç«¯ä¸­å®æ—¶æµå¼ä¼ è¾“ Worker çš„æ—¥å¿—ï¼ŒåŒ…æ‹¬ä»»ä½•æœªæ•è·çš„å¼‚å¸¸å’Œ `console.log` è¾“å‡ºã€‚</p>
                            <div class="code-block">
                                <pre><code class="language-bash text-sm bg-slate-900 text-white rounded-md p-4 block overflow-x-auto">$ npx wrangler tail your-worker-name</code></pre>
                                <button class="copy-button p-1 bg-slate-600 rounded-md text-white">ğŸ“‹</button>
                                <div class="copied-feedback">å·²å¤åˆ¶!</div>
                            </div>
                             <p class="mt-3 text-sm text-slate-600">å½“ 1101 é”™è¯¯å‘ç”Ÿæ—¶ï¼Œ`wrangler tail` ä¼šæ˜¾ç¤ºä¸€ä¸ªåŒ…å« `exception` å­—æ®µçš„ JSON å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«è¯¦ç»†çš„é”™è¯¯æ¶ˆæ¯å’Œå †æ ˆè·Ÿè¸ªï¼Œè¿™æ˜¯å®šä½é—®é¢˜çš„å…³é”®çº¿ç´¢ã€‚</p>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold mb-2">2. å…¨å±€ `try...catch`</h3>
                            <p class="mb-3">ä¸ºäº†é˜²æ­¢ä»»ä½•æœªé¢„æ–™çš„é”™è¯¯å¯¼è‡´ Worker å´©æºƒï¼Œæ‚¨å¯ä»¥åœ¨ä¸»å¤„ç†å‡½æ•°å¤–åŒ…è£¹ä¸€ä¸ªé¡¶å±‚çš„ `try...catch` å—ã€‚è¿™èƒ½ç¡®ä¿æ‚¨æ•è·åˆ°æ‰€æœ‰å¼‚å¸¸ï¼Œå¹¶é€šè¿‡ `console.error` å°†å…¶è®°å½•ä¸‹æ¥ï¼Œä»¥ä¾¿åœ¨ `wrangler tail` ä¸­æŸ¥çœ‹ã€‚</p>
                            <div class="code-block">
                                <pre><code class="language-js text-sm bg-slate-100 rounded-md p-4 block overflow-x-auto">export default {
  async fetch(request, env, ctx) {
    try {
      // æ‚¨ç°æœ‰çš„æ‰€æœ‰è¯·æ±‚å¤„ç†é€»è¾‘éƒ½æ”¾åœ¨è¿™é‡Œ
      return await handleRequest(request, env, ctx);
    } catch (e) {
      // è®°å½•è¯¦ç»†é”™è¯¯ä¿¡æ¯
      console.error("Top-level exception:", {
        message: e.message,
        stack: e.stack,
      });
      //å‘å®¢æˆ·ç«¯è¿”å›ä¸€ä¸ªå‹å¥½çš„é”™è¯¯å“åº”
      return new Response("Internal Server Error", { status: 500 });
    }
  }
};

async function handleRequest(request, env, ctx) {
  // ...æ‚¨çš„æ ¸å¿ƒé€»è¾‘...
}</code></pre>
                                <button class="copy-button p-1 bg-slate-300 rounded-md text-white">ğŸ“‹</button>
                                <div class="copied-feedback">å·²å¤åˆ¶!</div>
                            </div>
                        </div>
                         <div>
                            <h3 class="text-xl font-semibold mb-2">3. `wrangler dev` æœ¬åœ°å¼€å‘</h3>
                            <p class="mb-3">ä½¿ç”¨ `wrangler dev` å¯ä»¥åœ¨æœ¬åœ°æ¨¡æ‹Ÿ Cloudflare ç¯å¢ƒè¿›è¡Œå¼€å‘å’Œæµ‹è¯•ã€‚è¿™å¯¹äºå¿«é€Ÿè¿­ä»£å’Œå¤ç°é€»è¾‘é”™è¯¯éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥å¤§å¤§ç¼©çŸ­è°ƒè¯•å‘¨æœŸã€‚</p>
                             <div class="code-block">
                                <pre><code class="language-bash text-sm bg-slate-900 text-white rounded-md p-4 block overflow-x-auto">$ npx wrangler dev</code></pre>
                                <button class="copy-button p-1 bg-slate-600 rounded-md text-white">ğŸ“‹</button>
                                <div class="copied-feedback">å·²å¤åˆ¶!</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- è§£å†³æ–¹æ¡ˆ Section -->
            <section id="solutions" class="content-section">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h2 class="text-2xl font-bold mb-4">è§£å†³æ–¹æ¡ˆä¸ä»£ç æ¨¡å¼</h2>
                    <p class="mb-6">æ ¹æ®â€œå¸¸è§åŸå› â€å’Œâ€œè¯Šæ–­å·¥å…·â€çš„å‘ç°ï¼Œæ‚¨å¯ä»¥åº”ç”¨ä»¥ä¸‹ä»£ç æ¨¡å¼æ¥ä¿®å¤é—®é¢˜ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå¯¹æ‰€æœ‰å¯èƒ½å¤±è´¥çš„æ“ä½œï¼ˆI/Oã€æ•°æ®è§£æï¼‰éƒ½è¿›è¡Œé˜²å¾¡æ€§ç¼–ç¨‹ã€‚</p>
                    <div class="space-y-6">
                        <div>
                            <h3 class="text-xl font-semibold mb-2">ä¿®æ­£ R2 `get` æ“ä½œ</h3>
                            <p class="mb-3">å§‹ç»ˆæ£€æŸ¥ `get()` çš„è¿”å›å€¼æ˜¯å¦ä¸º `null`ã€‚</p>
                            <div class="code-block">
                                <pre><code class="language-js text-sm bg-slate-100 rounded-md p-4 block overflow-x-auto">const object = await env.sub_store.get(key);

if (object === null) {
  // å¯¹è±¡ä¸å­˜åœ¨ï¼Œè¿”å› 404 æˆ–å…¶ä»–é€‚å½“çš„å“åº”
  return new Response(`Object with key '${key}' not found`, { status: 404 });
}

// åªæœ‰åœ¨å¯¹è±¡å­˜åœ¨æ—¶æ‰ç»§ç»­æ“ä½œ
const body = await object.text();
return new Response(body);</code></pre>
                                <button class="copy-button p-1 bg-slate-300 rounded-md text-white">ğŸ“‹</button>
                                <div class="copied-feedback">å·²å¤åˆ¶!</div>
                            </div>
                        </div>
                         <div>
                            <h3 class="text-xl font-semibold mb-2">åŠ å›º `fetch` è°ƒç”¨</h3>
                            <p class="mb-3">åœ¨å°è¯•è§£æå“åº”ä½“ä¹‹å‰ï¼Œæ€»æ˜¯æ£€æŸ¥ `response.ok` å±æ€§ã€‚</p>
                             <div class="code-block">
                                <pre><code class="language-js text-sm bg-slate-100 rounded-md p-4 block overflow-x-auto">const response = await fetch(externalUrl);

if (!response.ok) {
  // è®°å½•é”™è¯¯å¹¶æŠ›å‡ºæˆ–è¿”å›é”™è¯¯å“åº”
  const errorText = await response.text();
  console.error(`External fetch failed: ${response.status}`, errorText);
  throw new Error(`Upstream service error: ${response.status}`);
}

// ç¡®ä¿å“åº”æˆåŠŸåå†è§£æ
const data = await response.json();
// ... ä½¿ç”¨ data ...</code></pre>
                                <button class="copy-button p-1 bg-slate-300 rounded-md text-white">ğŸ“‹</button>
                                <div class="copied-feedback">å·²å¤åˆ¶!</div>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold mb-2">ä½¿ç”¨ç»†ç²’åº¦çš„ `try...catch`</h3>
                            <p class="mb-3">é™¤äº†å…¨å±€ `try...catch`ï¼Œåœ¨æ¯ä¸ªå…·ä½“çš„å¼‚æ­¥æ“ä½œå‘¨å›´ä¹Ÿä½¿ç”¨å®ƒï¼Œå¯ä»¥æä¾›æ›´ç²¾ç¡®çš„é”™è¯¯ä¸Šä¸‹æ–‡ã€‚</p>
                             <div class="code-block">
                                <pre><code class="language-js text-sm bg-slate-100 rounded-md p-4 block overflow-x-auto">let externalData;
try {
  const response = await fetch(externalUrl);
  if (!response.ok) throw new Error(`API Error: ${response.status}`);
  externalData = await response.json();
} catch (e) {
  console.error("Failed to fetch or parse external data", e);
  return new Response("Failed to get upstream data", { status: 502 }); // Bad Gateway
}

try {
  await env.sub_store.put("my-key", JSON.stringify(externalData));
} catch (e) {
  console.error("Failed to put data to R2", e);
  return new Response("Failed to save data", { status: 500 });
}</code></pre>
                                <button class="copy-button p-1 bg-slate-300 rounded-md text-white">ğŸ“‹</button>
                                <div class="copied-feedback">å·²å¤åˆ¶!</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- é…ç½®æ ¸æŸ¥æ¸…å• Section -->
            <section id="checklist" class="content-section">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h2 class="text-2xl font-bold mb-4">R2 ç»‘å®šé…ç½®æ ¸æŸ¥æ¸…å•</h2>
                    <p class="mb-6">é”™è¯¯çš„é…ç½®ä¹Ÿå¯èƒ½å¯¼è‡´ä»£ç åœ¨è®¿é—® `env.sub_store` æ—¶å¤±è´¥ï¼Œå¼•å‘ `TypeError`ã€‚è¯·ä»”ç»†æ ¸å¯¹ä»¥ä¸‹é…ç½®é¡¹ã€‚</p>
                    <ul class="space-y-4">
                        <li class="flex items-start">
                            <span class="text-green-500 text-2xl mr-3">âœ”</span>
                            <div>
                                <h3 class="font-semibold">æ£€æŸ¥ `wrangler.toml` æ–‡ä»¶</h3>
                                <p class="text-slate-600 mb-2">ç¡®ä¿æ‚¨çš„ `wrangler.toml` æ–‡ä»¶ä¸­åŒ…å«äº†æ­£ç¡®çš„ R2 ç»‘å®šé…ç½®ã€‚`binding` çš„å€¼å¿…é¡»ä¸æ‚¨åœ¨ä»£ç ä¸­ä½¿ç”¨çš„ `env.sub_store` å®Œå…¨åŒ¹é…ã€‚</p>
                                <div class="code-block">
                                    <pre><code class="language-toml text-sm bg-slate-100 rounded-md p-4 block overflow-x-auto"># In wrangler.toml
[[r2_buckets]]
binding = "sub_store" # <-- å¿…é¡»æ˜¯ "sub_store"
bucket_name = "your-actual-r2-bucket-name" # <-- æ›¿æ¢ä¸ºæ‚¨çš„ R2 å­˜å‚¨æ¡¶çœŸå®åç§°</code></pre>
                                    <button class="copy-button p-1 bg-slate-300 rounded-md text-white">ğŸ“‹</button>
                                    <div class="copied-feedback">å·²å¤åˆ¶!</div>
                                </div>
                            </div>
                        </li>
                        <li class="flex items-start">
                             <span class="text-green-500 text-2xl mr-3">âœ”</span>
                            <div>
                                <h3 class="font-semibold">æ£€æŸ¥ Cloudflare ä»ªè¡¨ç›˜</h3>
                                <p class="text-slate-600">å¦‚æœæ‚¨æ˜¯é€šè¿‡ Cloudflare ä»ªè¡¨ç›˜ï¼ˆDashboardï¼‰æ¥ç®¡ç†ç»‘å®šçš„ï¼ˆä¾‹å¦‚ï¼Œå¯¹äº Pages Functionsï¼‰ï¼Œè¯·å¯¼èˆªåˆ°é¡¹ç›®çš„ `Settings` > `Functions` > `R2 bucket bindings`ã€‚ç¡®è®¤â€œå˜é‡åç§°â€(Variable name) æ˜¯ `sub_store`ï¼Œå¹¶ä¸”å®ƒå·²æ­£ç¡®é“¾æ¥åˆ°æ‚¨çš„ R2 å­˜å‚¨æ¡¶ã€‚</p>
                            </div>
                        </li>
                         <li class="flex items-start">
                             <span class="text-green-500 text-2xl mr-3">âœ”</span>
                            <div>
                                <h3 class="font-semibold">é‡æ–°éƒ¨ç½²</h3>
                                <p class="text-slate-600">åœ¨ä¿®æ”¹äº† `wrangler.toml` æˆ–ä»ªè¡¨ç›˜ä¸­çš„ä»»ä½•ç»‘å®šé…ç½®åï¼Œè¯·åŠ¡å¿…é‡æ–°éƒ¨ç½²æ‚¨çš„ Worker ä»¥ä½¿æ›´æ”¹ç”Ÿæ•ˆã€‚</p>
                            </div>
                        </li>
                    </ul>
                    <div class="mt-6 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded-r-lg">
                        <h4 class="font-semibold text-yellow-800">é‡è¦æç¤º</h4>
                        <p class="text-yellow-700">å¦‚æœç»‘å®šé…ç½®é”™è¯¯ï¼Œ`env.sub_store` åœ¨è¿è¡Œæ—¶ä¼šæ˜¯ `undefined`ã€‚æ­¤æ—¶è°ƒç”¨ `env.sub_store.get()` ä¼šç›´æ¥å¯¼è‡´ `TypeError: Cannot read properties of undefined (reading 'get')`ï¼Œè¿™æ˜¯ 1101 é”™è¯¯çš„ä¸€ä¸ªéå¸¸å…·ä½“ä¸”å¸¸è§çš„åŸå› ã€‚</p>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const navButtons = document.querySelectorAll('.nav-button');
            const sections = document.querySelectorAll('.content-section');
            const accordionToggles = document.querySelectorAll('.accordion-toggle');
            const copyButtons = document.querySelectorAll('.copy-button');

            // Navigation logic
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetSectionId = button.dataset.section;

                    navButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');

                    sections.forEach(section => {
                        if (section.id === targetSectionId) {
                            section.classList.add('active');
                        } else {
                            section.classList.remove('active');
                        }
                    });
                });
            });

            // Accordion logic
            accordionToggles.forEach(toggle => {
                toggle.addEventListener('click', () => {
                    const content = toggle.nextElementSibling;
                    const arrow = toggle.querySelector('.accordion-arrow');
                    
                    toggle.parentElement.classList.toggle('open');

                    if (content.style.maxHeight) {
                        content.style.maxHeight = null;
                        arrow.style.transform = 'rotate(0deg)';
                    } else {
                        content.style.maxHeight = content.scrollHeight + "px";
                         arrow.style.transform = 'rotate(180deg)';
                    }
                });
            });
            
            // Copy to clipboard logic
            copyButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const codeBlock = button.previousElementSibling;
                    const codeText = codeBlock.innerText;
                    
                    const tempTextArea = document.createElement('textarea');
                    tempTextArea.value = codeText;
                    document.body.appendChild(tempTextArea);
                    tempTextArea.select();
                    try {
                        document.execCommand('copy');
                        const feedback = button.nextElementSibling;
                        feedback.style.display = 'inline-block';
                        setTimeout(() => {
                            feedback.style.display = 'none';
                        }, 2000);
                    } catch (err) {
                        console.error('Failed to copy text: ', err);
                    }
                    document.body.removeChild(tempTextArea);
                });
            });
        });
    </script>
</body>
</html>

